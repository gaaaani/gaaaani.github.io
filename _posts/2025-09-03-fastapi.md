---
title: "FastAPIë¡œ ê°œë°œí•˜ê¸°"
date: 2025-09-03 12:00:00 +0900
categories: [Study, FastAPI]
tags: [FastAPI, Python, Uvicorn, Backend]
pin: true
toc: true 
---

## ğŸ—‚ï¸ ëª©ì°¨

1. [intro](#1-intro)


---

## 1. intro

2ì°¨ í”„ë¡œì íŠ¸ë¡œ ê¸ˆìœµ ì„œë¹„ìŠ¤ì— LLMì„ ì—°ë™í•˜ê¸° ìœ„í•´ì„œ íŒŒì´ì¬ ì›¹ í”„ë ˆì„ì›Œí¬ê°€ í•„ìš”í–ˆë‹¤.
DRF(Django Rest Framework)ì™€ Flaskë¡œ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•´ ë³¸ ê²½í—˜ì´ ìˆì—ˆì§€ë§Œ,  
ë°±ì—”ë“œëŠ” SpringBootë¥¼ ë©”ì¸ìœ¼ë¡œ ê°€ì ¸ê°€ê¸° ìœ„í•´ì„œ FastAPIë¥¼ ì‚¬ìš©í•´ë³´ê³ ì í•œë‹¤.  

ì´ë²ˆ ê¸€ì—ì„œëŠ” ê°€ìƒí™˜ê²½ì„ ë§Œë“¤ê³ , FastAPI ì•±ì„ ë„ìš´ ë’¤, Swagger UI(/docs) ë¡œ APIê°€ ì •ìƒ ë…¸ì¶œë˜ëŠ”ì§€ í™•ì¸í•´ ë³¼ ì˜ˆì •ì´ë‹¤.  
(LLM ì—°ë™ì€ ë‹¤ìŒ ê¸€ì—ì„œ ë‹¤ë£° ì˜ˆì • ğŸ˜‰)


---

## 2. FastAPIë€?

**FastAPI**ëŠ” íŒŒì´ì¬ ê¸°ë°˜ì˜ ì›¹ í”„ë ˆì„ì›Œí¬ë¡œ APIë¥¼ ë§Œë“œëŠ”ë° ì§‘ì¤‘ì ìœ¼ë¡œ ì‚¬ìš©ë˜ë©°, ì´ë¦„ì— ê±¸ë§ê²Œ ë¹ ë¥´ë‹¤ê³  í•œë‹¤.  


### ğŸ” FastAPI ì¥ì 
- **íƒ€ì… ì•ˆì •ì„±**: typing + Pydanticìœ¼ë¡œ ìš”ì²­/ì‘ë‹µ ìŠ¤í‚¤ë§ˆ ê²€ì¦ ìë™  
    - í•¨ìˆ˜ì— íƒ€ì… íŒíŠ¸ë¥¼ ë‹¬ë©´, ê·¸ê±¸ ê·¼ê±°ë¡œ ìš”ì²­ ê²€ì¦ê³¼ ì‘ë‹µ ì§ë ¬í™”ë¥¼ ìë™ìœ¼ë¡œ ì²˜ë¦¬   
    - ëŸ°íƒ€ì„ì‹œ Pydanticì´ ë°ì´í„° íƒ€ì…ì„ ë³€í™˜/ê²€ì¦í•´ ë²„ê·¸ë¥¼ ì´ˆê¸°ì— ì°¨ë‹¨í•´ì¤Œ   
- **ìë™ ë¬¸ì„œí™”** : OpenAPI ìŠ¤í™ â†’ /docs ë°”ë¡œ ìƒì„±  
    - ìë™ìœ¼ë¡œ API ë¬¸ì„œ(ì›¹)ì„ í†µí•´ì„œ ë°”ë¡œ í…ŒìŠ¤íŠ¸ í•  ìˆ˜ ìˆìŒ (Swagger)  
- **ê³ ì„±ëŠ¥/ë¹„ë™ê¸°**: ASGI(Uvicorn)ë¡œ ë™ì‹œì„± ìš°ìˆ˜ 
    - FastAPIëŠ” WSGI(ë™ê¸°) ëŒ€ì‹  ASGI(ë¹„ë™ê¸°) ìŠ¤íƒ(Starlette + Uvicorn)ì„ ì‚¬ìš©   
      I/O ë°”ìš´ë“œ ì‘ì—…(DB, ì™¸ë¶€ API, íŒŒì¼, ìŠ¤íŠ¸ë¦¬ë°)ì— ë™ì‹œì„± ì²˜ë¦¬ ê°•í•¨  
    ** ASGI : íŒŒì´ì¬ ì›¹ ì„œë²„, í”„ë ˆì„ì›Œí¬, ì• í”Œë¦¬ì¼€ì´ì…˜ ê°„ì˜ í†µì‹ ì„ ìœ„í•œ í‘œì¤€ ì¸í„°í˜ì´ìŠ¤  
    - ì—”ë“œí¬ì¸íŠ¸ë¥¼ async defë¡œ ì‘ì„±í•˜ë©´ await ê°€ëŠ¥í•œ í˜¸ì¶œì„ ë…¼ë¸”ë¡œí‚¹ìœ¼ë¡œ ì²˜ë¦¬  
    - ì›¹ì†Œì¼“/ìŠ¤íŠ¸ë¦¬ë°ì—ë„ ê¸°ë³¸ì ìœ¼ë¡œ ê°•í•¨  

---

## 3. ê°œë°œ í™˜ê²½

ì´ ê¸€ì€ Windows ìœ ì €ê°€ ì“´ ê¸€ì´ê¸° ë•Œë¬¸ì— Windows ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŒì„ ë¯¸ë¦¬ ì•Œë¦½ë‹ˆë‹¤.  
- Shell: Git Bash(MINGW64) ë˜ëŠ” PowerShell
- IDE: VS Code
- Python: 3.13.7  
 

---

## 4. ê°€ìƒí™˜ê²½ ì„¤ì •

### ê°€ìƒí™˜ê²½?  
í”„ë¡œì íŠ¸ì˜ íŒ¨í‚¤ì§€ **ë²„ì „ ì¶©ëŒì„ ë§‰ê³ ** **ì˜ì¡´ì„± ì¼ì¹˜**ë¥¼ ë³´ì¥í•˜ê¸° ìœ„í•´ ê°€ìƒí™˜ê²½ì„ ì‚¬ìš©í•¨!  
- ë…ë¦½ëœ ê°œë°œ í™˜ê²½ êµ¬ì„± ê°€ëŠ¥  
- í˜‘ì—…ì‹œ ë²„ì „ ê´€ë¦¬ì— ìš©ì´í•¨  

ì–¸ì–´ëŠ” ë‹¤ë¥´ì§€ë§Œ Spring Bootì—ì„œ ì‚¬ìš©ë˜ëŠ” ì¼ì¢…ì˜ ì˜ì¡´ì„±ì´ë‚˜ ë²„ì „ê´€ë¦¬ ìš©ë„ì¸ pom.xmlì´ë‚˜ build.gradleê³¼ ìœ ì‚¬í•˜ë‹¤ê³  í•  ìˆ˜ ìˆìŒ.  

### ê°€ìƒí™˜ê²½ ì„¤ì •í•˜ê¸°   
- í”„ë¡œì íŠ¸ ë£¨íŠ¸ í´ë”ë¡œ ì´ë™í•´ ê°€ìƒí™˜ê²½ì„ ì„¤ì •í•œë‹¤.  

ë°©ë²•ìœ¼ë¡œ ê°€ìƒí™˜ê²½ .venvë¥¼ ì„¤ì •í•´ì£¼ë©´ êµ¬ì¡°ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.  

``` 
venvproj/            # ë£¨íŠ¸í´ë”
â”œâ”€ .venv/            # ê°€ìƒí™˜ê²½
â””â”€ app/
   â”œâ”€ __init__.py
   â””â”€ main.py

```

**ë£¨íŠ¸ í´ë”ì—ì„œ ê°€ìƒí™˜ê²½ ì„¤ì •í•´ì•¼ í•¨!!**   
ë£¨íŠ¸ì—ì„œ ê°€ìƒí™˜ê²½ì„ ì„¤ì •í•´ì•¼ í•œë‹¤. ì˜ëª»ëœ ê²½ë¡œì— í•˜ì§€ ì•Šë„ë¡ ì£¼ì˜í•˜ì!  

```bash
cd ../venvproj        # ë£¨íŠ¸ í´ë”ë¡œ ì´ë™  
python -m venv .venv  #.venvë¼ëŠ” ê°€ìƒí™˜ê²½ ìƒì„±  
# (ì„ íƒ) íŠ¹ì • ë²„ì „ìœ¼ë¡œ ë§Œë“¤ê³  ì‹¶ë‹¤ë©´
# py -3.12 -m venv .venv  

```

.venvì˜ ê°€ìƒí™˜ê²½ì„ ì‹¤í–‰í•˜ê¸° ìœ„í•´ì„œ venvì˜ Scriptsë¥¼ í™œì„±í™” í•´ì£¼ë©´ ëœë‹¤.  
í™œì„±í™”ë˜ë©´ í”„ë¡¬í¬íŠ¸ ì•ì— (.venv)í‘œì‹œ ìƒê¹€   

```bash
source .venv/Scripts/activate # í™œì„±í™”
deactivate                    # ë¹„í™œì„±í™”
```

ì •ìƒ ë™ì‘ í™•ì¸  
```bash
python -V
pip -V
python -c "import sys; print(sys.executable)"
# ì¶œë ¥ ê²½ë¡œì— .../exproj/.venv/ ê°€ í¬í•¨ë˜ì–´ ìˆìœ¼ë©´ OK
```
ê¸°ë³¸ íŒ¨í‚¤ì§€ ì„¤ì¹˜  
pipë¥¼ ìµœì‹  ë²„ì „ìœ¼ë¡œ ì„¤ì¹˜í•˜ê³ , FastAPI ì„œë²„ë¥¼ ìœ„í•œ ìµœì†Œ íŒ¨í‚¤ì§€ ì„¤ì¹˜  
```bash
python -m pip install -U pip 
python -m pip install fastapi "uvicorn[standard]"
```
- uvicorn[standard]: FastAPI ì•±ì„ ì‹¤í–‰í•˜ëŠ” ASGI ì„œë²„  

  


## 5. app í´ë” ì„¤ì •

ë£¨íŠ¸ ê²½ë¡œ ë°‘ì— app í´ë”ë¥¼ ìƒì„±í•œë‹¤.
ì—¬ê¸°ì„œ íŒŒì´ì¬ ì½”ë“œ(ì—”ë“œí¬ì¸íŠ¸), ë¼ìš°í„°, ì˜ˆì œ(JSON)ë¥¼ ê´€ë¦¬í•œë‹¤.  

### ë””ë ‰í„°ë¦¬ êµ¬ì¡°

```
exproj/
â”œâ”€ .venv/
â””â”€ app/
   â”œâ”€ __init__.py
   â”œâ”€ main.py
   â”œâ”€ routers/
   â”‚  â”œâ”€ __init__.py
   â”‚  â””â”€ example.py
   â””â”€ examples/
      â”œâ”€ spending_series.json
      â””â”€ advice.json

``` 

íŒŒì¼ ìƒì„±ì€ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•´ë„ ë˜ê³ , ì§ì ‘ ìƒì„±í•´ë„ ëœë‹¤.  
``` bash
mkdir -p app/routers app/examples
:> app/__init__.py
:> app/routers/__init__.py
```

ì•„ë˜ ì½”ë“œë¥¼ ì¶”ê°€í•œ ë’¤ ì„œë²„ë¥¼ ì‹¤í–‰í•´ ì˜ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•˜ì~!  

**app/main.py**
```python
import os
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
from app.routers import demo

# í™˜ê²½ë³€ìˆ˜ë¡œ API prefixì™€ CORS í—ˆìš© ì˜¤ë¦¬ì§„ì„ ì œì–´
API_PREFIX = os.getenv("API_AI_PREFIX", "/v1")

app = FastAPI(title="Ohgoodpay ML", version="0.1.0")

# CORS ì„¤ì •
app.add_middleware(
    CORSMiddleware,
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# ë¼ìš°í„° ì˜ˆì‹œ
# ì˜ˆì‹œ: demo.py íŒŒì¼ì— ì‘ì„±í•œ ë¼ìš°í„°
app.include_router(demo.router, prefix=API_PREFIX, tags=["demo"])

# ê°„ë‹¨ í•‘ ì—”ë“œí¬ì¸íŠ¸ 
@app.get(API_PREFIX + "/ping")
def ping():
    return {"service": "ohgoodpay-ai", "status": "ok"}

```  

**app/routers/demo.py**
```python
from fastapi import APIRouter, HTTPException
from fastapi.responses import HTMLResponse, JSONResponse
from pathlib import Path
import json

router = APIRouter()
EXAMPLES_DIR = Path(__file__).resolve().parents[1] / "examples"  # app/examples

def read_json(name: str):
    p = EXAMPLES_DIR / name
    if not p.exists():
        raise HTTPException(404, f"Not found: {p}")
    text = p.read_text(encoding="utf-8-sig").strip()  # BOM í—ˆìš© + ê³µë°± ì œê±°
    if not text:
        raise HTTPException(500, f"{p.name} is empty")
    try:
        return JSONResponse(json.loads(text))
    except json.JSONDecodeError as e:
        raise HTTPException(500, f"JSON parse error in {p.name}: line {e.lineno}, col {e.colno} - {e.msg}")

@router.get("/demo", response_class=HTMLResponse)
def demo_page():
    idx = EXAMPLES_DIR / "index.html"
    return idx.read_text(encoding="utf-8") if idx.exists() else "<h1>Demo</h1>"

@router.get("/demo/bnpl-usage/series")
def demo_bnpl_series():
    return read_json("bnpl_series.json")

@router.get("/demo/spending/series")
def demo_spending_series():
    return read_json("spending_series.json")

@router.post("/demo/advice")
def demo_advice():
    return read_json("advice.json")

# ë””ë²„ê·¸: íŒŒì¼ ëª©ë¡/í¬ê¸° í™•ì¸ìš©
@router.get("/demo/debug/files")
def demo_files():
    return [
        {"name": p.name, "size": p.stat().st_size}
        for p in EXAMPLES_DIR.glob("*")
    ]

```

**app/examples/spending_series.json**

```json
{
  "userId": "demo",
  "groupBy": "category",
  "labels": ["ì‹ë¹„","êµí†µ","ì‡¼í•‘","êµ¬ë…"],
  "values": [430000, 120000, 310000, 45000],
  "trend": {
    "x": ["2025-06","2025-07","2025-08"],
    "series": {
      "ì‹ë¹„":  [120000,140000,170000],
      "ì‡¼í•‘":  [80000,110000,120000]
    }
  }
}
```

